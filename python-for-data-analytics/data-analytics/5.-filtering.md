# 5. Filtering&#x20;

In this session we are going to cover filtering. Filtering is getting the data that you want from your dataset.

## Types of Filtering

There are two types of filtering:

* iloc (index location) - filtering with the help of index.
* loc (location) - filtering with the help of values.

{% stepper %}
{% step %}
### iloc

First we are going to filter with the help of index.

```python
import pandas as pd
df = pd.read_csv('retail_sales_dataset.csv')
df
```

Output (first & last rows shown):

|     | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| --- | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 0   | CUST001     | Male   | 34  | Beauty           | 3        | 50             |
| 1   | CUST002     | Female | 26  | Clothing         | 2        | 500            |
| 2   | CUST003     | Male   | 50  | Electronics      | 1        | 30             |
| 3   | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 4   | CUST005     | Male   | 30  | Beauty           | 2        | 50             |
| ... | ...         | ...    | ... | ...              | ...      | ...            |
| 995 | CUST996     | Male   | 62  | Clothing         | 1        | 50             |
| 996 | CUST997     | Male   | 52  | Beauty           | 3        | 30             |
| 997 | CUST998     | Female | 23  | Beauty           | 4        | 25             |
| 998 | CUST999     | Female | 36  | Electronics      | 3        | 50             |
| 999 | CUST1000    | Male   | 47  | Electronics      | 4        | 30             |

1000 rows × 6 columns

#### Getting any row in DataFrame

To get any row in a DataFrame, specify the row index.

```python
df.iloc[0]  # gets the first row
```

Output:

Customer ID CUST001\
Gender Male\
Age 34\
Product Category Beauty\
Quantity 3\
Price per Unit 50\
Name: 0, dtype: object

#### Getting multiple rows in DataFrame

Specify a list of indices in iloc.

```python
df.iloc[[0, 3, 5]]
```

Output:

|   | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| - | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 0 | CUST001     | Male   | 34  | Beauty           | 3        | 50             |
| 3 | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 5 | CUST006     | Female | 45  | Beauty           | 1        | 30             |

#### Slicing multiple rows in DataFrame

Use Python-style slicing on indices.

```python
df.iloc[2:5]
```

Output:

|   | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| - | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 2 | CUST003     | Male   | 50  | Electronics      | 1        | 30             |
| 3 | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 4 | CUST005     | Male   | 30  | Beauty           | 2        | 50             |

#### Getting a single value in DataFrame

A single value has two indices: row and column.

```python
df.iloc[0, 0]
```

Output:

'CUST001'

#### Getting random rows and random columns in DataFrame

Specify lists of rows and columns.

```python
df.iloc[[0, 3, 5], [0, 2, 4]]
```

Output:

|   | Customer ID | Age | Quantity |
| - | ----------- | --- | -------- |
| 0 | CUST001     | 34  | 3        |
| 3 | CUST004     | 37  | 1        |
| 5 | CUST006     | 45  | 1        |

#### Slicing rows and columns in DataFrame

You can slice both rows and columns.

```python
df.iloc[0:3, 2:4]
```

Output:

|   | Age | Product Category |
| - | --- | ---------------- |
| 0 | 34  | Beauty           |
| 1 | 26  | Clothing         |
| 2 | 50  | Electronics      |

#### How would you get a single column?

Get a single column by slicing all rows and specifying the column index.

```python
df.iloc[:, 1]
```

Output (truncated):

0 Male\
1 Female\
2 Male\
3 Male\
4 Male\
...\
995 Male\
996 Male\
997 Female\
998 Female\
999 Male\
Name: Gender, Length: 1000, dtype: object

{% hint style="info" %}
Note: iloc is used to get data by index (integer location).
{% endhint %}
{% endstep %}

{% step %}
### loc

loc is used to filter data by values. The syntax is:

```python
df.loc[Condition]
```

* If Condition is True, the row is included.
* If Condition is False, the row is excluded.

#### Filter data where Gender is Male

```python
mdf = df.loc[df['Gender'] == 'Male']
mdf.head()
```

Output:

|   | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| - | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 0 | CUST001     | Male   | 34  | Beauty           | 3        | 50             |
| 2 | CUST003     | Male   | 50  | Electronics      | 1        | 30             |
| 3 | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 4 | CUST005     | Male   | 30  | Beauty           | 2        | 50             |
| 6 | CUST007     | Male   | 46  | Clothing         | 2        | 25             |

#### Filter data where Age is greater than 50

```python
fdf = df.loc[df['Age'] > 50]
fdf.head()
```

Output:

|    | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| -- | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 8  | CUST009     | Male   | 63  | Electronics      | 2        | 300            |
| 9  | CUST010     | Female | 52  | Clothing         | 4        | 50             |
| 13 | CUST014     | Male   | 64  | Clothing         | 4        | 30             |
| 18 | CUST019     | Female | 62  | Clothing         | 2        | 25             |
| 24 | CUST025     | Female | 64  | Beauty           | 1        | 50             |

#### Multiple conditions in filtering

Use pandas-compatible logical operators (not Python's and/or):

* & (ampersand) — logical AND (both conditions must be true)
* \| (pipe) — logical OR (any condition true)
* != — not equal
* \~ (tilde) — logical NOT (negates the condition)

Note: Always wrap each condition in parentheses when combining multiple conditions.

**& - Filter where Gender is Male and Age is greater than 50**

```python
mdf = df.loc[(df['Gender'] == 'Male') & (df['Age'] > 50)]
mdf
```

Output (truncated):

|     | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| --- | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 8   | CUST009     | Male   | 63  | Electronics      | 2        | 300            |
| 13  | CUST014     | Male   | 64  | Clothing         | 4        | 30             |
| 35  | CUST036     | Male   | 52  | Beauty           | 3        | 300            |
| 47  | CUST048     | Male   | 54  | Electronics      | 3        | 300            |
| 58  | CUST059     | Male   | 62  | Clothing         | 1        | 50             |
| ... | ...         | ...    | ... | ...              | ...      | ...            |
| 969 | CUST970     | Male   | 59  | Electronics      | 4        | 500            |
| 972 | CUST973     | Male   | 60  | Clothing         | 1        | 50             |
| 983 | CUST984     | Male   | 56  | Clothing         | 1        | 500            |
| 995 | CUST996     | Male   | 62  | Clothing         | 1        | 50             |
| 996 | CUST997     | Male   | 52  | Beauty           | 3        | 30             |

155 rows × 6 columns

**& - Filter where Age is between 20 to 30**

```python
mdf = df.loc[(df['Age'] > 20) & (df['Age'] < 30)]
mdf.head()
```

Output:

|    | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| -- | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 1  | CUST002     | Female | 26  | Clothing         | 2        | 500            |
| 10 | CUST011     | Male   | 23  | Clothing         | 2        | 50             |
| 12 | CUST013     | Male   | 22  | Electronics      | 3        | 500            |
| 16 | CUST017     | Female | 27  | Clothing         | 4        | 25             |
| 19 | CUST020     | Male   | 22  | Clothing         | 3        | 300            |

**| - Filter where Category is Clothing or Electronics**

```python
mdf = df.loc[(df['Product Category'] == 'Clothing') | (df['Product Category'] == 'Electronics')]
mdf.head()
```

Output:

|   | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| - | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 1 | CUST002     | Female | 26  | Clothing         | 2        | 500            |
| 2 | CUST003     | Male   | 50  | Electronics      | 1        | 30             |
| 3 | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 6 | CUST007     | Male   | 46  | Clothing         | 2        | 25             |
| 7 | CUST008     | Male   | 30  | Electronics      | 4        | 25             |

**!= - Filter where data is not equal to Electronics**

```python
mdf = df.loc[df['Product Category'] != 'Electronics']
mdf.head()
```

Output:

|   | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| - | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 0 | CUST001     | Male   | 34  | Beauty           | 3        | 50             |
| 1 | CUST002     | Female | 26  | Clothing         | 2        | 500            |
| 2 | CUST003     | Male   | 50  | Electronics      | 1        | 30             |
| 3 | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 4 | CUST005     | Male   | 30  | Beauty           | 2        | 50             |

**\~ - Negation (logical NOT)**

\~ negates the condition; it returns rows that do not match the given condition.

```python
mdf = df.loc[~(df['Product Category'] != 'Electronics')]
mdf.head()
```

Output:

|    | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| -- | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 2  | CUST003     | Male   | 50  | Electronics      | 1        | 30             |
| 7  | CUST008     | Male   | 30  | Electronics      | 4        | 25             |
| 8  | CUST009     | Male   | 63  | Electronics      | 2        | 300            |
| 12 | CUST013     | Male   | 22  | Electronics      | 3        | 500            |
| 14 | CUST015     | Female | 42  | Electronics      | 4        | 500            |

**\~ - Example: Filter where Gender is not Male and Category is not Electronics**

```python
mdf = df.loc[~((df['Gender'] == 'Male') & (df['Product Category'] == 'Electronics'))]
mdf.head()
```

Output:

|   | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| - | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 0 | CUST001     | Male   | 34  | Beauty           | 3        | 50             |
| 1 | CUST002     | Female | 26  | Clothing         | 2        | 500            |
| 3 | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 4 | CUST005     | Male   | 30  | Beauty           | 2        | 50             |
| 5 | CUST006     | Female | 45  | Beauty           | 1        | 30             |

#### isin() — filter multiple values

isin() filters rows matching any value in a list.

```python
mdf = df.loc[df['Product Category'].isin(['Electronics', 'Clothing'])]
mdf.head()
```

Output:

|   | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| - | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 1 | CUST002     | Female | 26  | Clothing         | 2        | 500            |
| 2 | CUST003     | Male   | 50  | Electronics      | 1        | 30             |
| 3 | CUST004     | Male   | 37  | Clothing         | 1        | 500            |
| 6 | CUST007     | Male   | 46  | Clothing         | 2        | 25             |
| 7 | CUST008     | Male   | 30  | Electronics      | 4        | 25             |

#### between() — filter between two values

between() filters values between two endpoints (inclusive by default).

```python
mdf = df.loc[df['Age'].between(20, 30)]
mdf
```

Output (truncated):

|     | Customer ID | Gender | Age | Product Category | Quantity | Price per Unit |
| --- | ----------- | ------ | --- | ---------------- | -------- | -------------- |
| 1   | CUST002     | Female | 26  | Clothing         | 2        | 500            |
| 4   | CUST005     | Male   | 30  | Beauty           | 2        | 50             |
| 7   | CUST008     | Male   | 30  | Electronics      | 4        | 25             |
| 10  | CUST011     | Male   | 23  | Clothing         | 2        | 50             |
| 12  | CUST013     | Male   | 22  | Electronics      | 3        | 500            |
| ... | ...         | ...    | ... | ...              | ...      | ...            |
| 970 | CUST971     | Female | 27  | Electronics      | 4        | 50             |
| 980 | CUST981     | Female | 30  | Electronics      | 2        | 30             |
| 982 | CUST983     | Female | 29  | Clothing         | 1        | 300            |
| 986 | CUST987     | Female | 30  | Clothing         | 3        | 300            |
| 997 | CUST998     | Female | 23  | Beauty           | 4        | 25             |

231 rows × 6 columns
{% endstep %}
{% endstepper %}

### Assignments

Use **Adidas US Sales Datasets** from required files.

* Get all rows where the Sales Method is "In-store".
* Find all transactions with a Price per Unit equal to $50.
* Retrieve rows where the City is "New York".
* Get rows where the Product is "Men's Apparel".
* Show rows where Units Sold is greater than 1000.
* Find all records where the State is not "New York".
* Retrieve rows where Price per Unit is less than $45.
* Get all transactions where the Region is "Northeast".
* Show rows where the Product contains the word "Footwear".
* Filter rows where the Product starts with "Women's".
* Find rows where Sales Method is "In-store" **and** Product is "Men's Street Footwear".
* Get rows where Sales Method is "Outlet" **or** Product is "Men's Apparel".
* Retrieve rows where Units Sold > 1000 **and** Price per Unit < $50.
* Show rows where Product is not "Women's Apparel" **and** Sales Method is "In-store".
* Get rows where Product contains "Athletic" **or** "Street".
* Retrieve rows where Units Sold <= 900 **or** Price per Unit >= $60.
* Show rows where Product is not "Men's Athletic Footwear".
* Find all rows where Sales Method is **not** "Outlet".
* Filter rows where the State is "New York" **and** Sales Method is "Outlet".
* Get rows where Region is not "Northeast" **or** Units Sold < 950.
* Select the first 10 rows using `iloc`.
* Retrieve rows from index 100 to 200 using `iloc`.
* Get the last 10 rows using `iloc`.
* Select rows at even-numbered indices only.
* Get rows where the Invoice Date is after "10-01-2020".
* Retrieve all rows where the Product name ends with "Apparel".
* Get all rows where the Units Sold is between 800 and 1000 (inclusive).
* Filter all transactions where both Sales Method and Product are the same as the previous row.
* Exclude all rows where Product includes "Apparel" **and** Sales Method is "Outlet".
